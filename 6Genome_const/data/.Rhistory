c("GO:0019104","DNA N-glycosylase activity",0.171,0.833,0.635,"peptidoglycan beta-N-acetylmuramidase activity"),
c("GO:0016997","alpha-sialidase activity",0.022,0.854,0.492,"peptidoglycan beta-N-acetylmuramidase activity"),
c("GO:0016996","endo-alpha-(2,8)-sialidase activity",0.000,0.894,0.266,"peptidoglycan beta-N-acetylmuramidase activity"),
c("GO:0004568","chitinase activity",0.021,0.854,0.348,"peptidoglycan beta-N-acetylmuramidase activity"),
c("GO:0008843","endochitinase activity",0.000,0.883,0.394,"peptidoglycan beta-N-acetylmuramidase activity"),
c("GO:0005515","protein binding",4.410,0.964,0.074,"protein binding"),
c("GO:0050662","coenzyme binding",3.468,0.948,0.080,"coenzyme binding"),
c("GO:0050661","NADP binding",0.587,0.931,0.640,"coenzyme binding"),
c("GO:0030170","pyridoxal phosphate binding",1.157,0.929,0.696,"coenzyme binding"),
c("GO:0070403","NAD+ binding",0.096,0.934,0.528,"coenzyme binding"),
c("GO:0048037","cofactor binding",5.599,0.963,0.087,"cofactor binding"),
c("GO:0004170","dUTP diphosphatase activity",0.031,0.854,0.098,"dUTP diphosphatase activity"),
c("GO:0016798","hydrolase activity, acting on glycosyl bonds",1.822,0.833,0.290,"dUTP diphosphatase activity"),
c("GO:0016817","hydrolase activity, acting on acid anhydrides",7.223,0.809,0.409,"dUTP diphosphatase activity"),
c("GO:0016810","hydrolase activity, acting on carbon-nitrogen (but not peptide) bonds",1.786,0.834,0.193,"dUTP diphosphatase activity"),
c("GO:0016788","hydrolase activity, acting on ester bonds",4.643,0.817,0.372,"dUTP diphosphatase activity"),
c("GO:0004197","cysteine-type endopeptidase activity",0.093,0.846,0.597,"dUTP diphosphatase activity"),
c("GO:0004190","aspartic-type endopeptidase activity",0.269,0.834,0.666,"dUTP diphosphatase activity"),
c("GO:0004176","ATP-dependent peptidase activity",0.094,0.815,0.598,"dUTP diphosphatase activity"),
c("GO:0047429","nucleoside-triphosphate diphosphatase activity",0.138,0.838,0.352,"dUTP diphosphatase activity"),
c("GO:0008094","DNA-dependent ATPase activity",0.593,0.810,0.601,"dUTP diphosphatase activity"),
c("GO:0004386","helicase activity",1.222,0.806,0.446,"dUTP diphosphatase activity"),
c("GO:0008186","RNA-dependent ATPase activity",0.106,0.833,0.365,"dUTP diphosphatase activity"),
c("GO:0004427","inorganic diphosphatase activity",0.064,0.847,0.318,"dUTP diphosphatase activity"),
c("GO:0008234","cysteine-type peptidase activity",0.411,0.830,0.697,"dUTP diphosphatase activity"),
c("GO:0008233","peptidase activity",4.049,0.820,0.357,"dUTP diphosphatase activity"),
c("GO:0070001","aspartic-type peptidase activity",0.269,0.836,0.666,"dUTP diphosphatase activity"),
c("GO:0003724","RNA helicase activity",0.087,0.833,0.360,"dUTP diphosphatase activity"),
c("GO:0003918","DNA topoisomerase type II (ATP-hydrolyzing) activity",0.138,0.818,0.614,"dUTP diphosphatase activity"),
c("GO:0070011","peptidase activity, acting on L-amino acid peptides",3.584,0.796,0.318,"dUTP diphosphatase activity"),
c("GO:0016887","ATPase activity",4.560,0.780,0.670,"dUTP diphosphatase activity"));
stuff <- data.frame(revigo.data);
names(stuff) <- revigo.names;
stuff$abslog10pvalue <- as.numeric( as.character(stuff$abslog10pvalue) );
stuff$freqInDbPercent <- as.numeric( as.character(stuff$freqInDbPercent) );
stuff$uniqueness <- as.numeric( as.character(stuff$uniqueness) );
stuff$dispensability <- as.numeric( as.character(stuff$dispensability) );
# by default, outputs to a PDF file
pdf( file="revigo_treemap.pdf", width=16, height=9 ) # width and height are in inches
# check the tmPlot command documentation for all possible parameters - there are a lot more
tmPlot(
stuff,
index = c("representative","description"),
vSize = "abslog10pvalue",
type = "categorical",
vColor = "representative",
title = "REVIGO Gene Ontology treemap",
inflate.labels = FALSE,      # set this to TRUE for space-filling group labels - good for posters
lowerbound.cex.labels = 0,   # try to draw as many labels as possible (still, some small squares may not get a label)
bg.labels = "#CCCCCCAA",     # define background color of group labels
# "#CCCCCC00" is fully transparent, "#CCCCCCAA" is semi-transparent grey, NA is opaque
position.legend = "none"
)
dev.off()
list.files()
library(treemap)
install.packages("treemap")
library("treemap")
# A treemap R script produced by the REVIGO server at http://revigo.irb.hr/
# If you found REVIGO useful in your work, please cite the following reference:
# Supek F et al. "REVIGO summarizes and visualizes long lists of Gene Ontology
# terms" PLoS ONE 2011. doi:10.1371/journal.pone.0021800
# author: Anton Kratz <anton.kratz@gmail.com>, RIKEN Omics Science Center, Functional Genomics Technology Team, Japan
# created: Fri, Nov 02, 2012  7:25:52 PM
# last change: Fri, Nov 09, 2012  3:20:01 PM
# -----------------------------------------------------------------------------
# If you don't have the treemap package installed, uncomment the following line:
# install.packages( "treemap" );
library(treemap) 								# treemap package by Martijn Tennekes
# Set the working directory if necessary
# setwd("C:/Users/username/workingdir");
# --------------------------------------------------------------------------
# Here is your data from REVIGO. Scroll down for plot configuration options.
revigo.names <- c("term_ID","description","freqInDbPercent","uniqueness","dispensability","representative");
revigo.data <- rbind(c("GO:0003700","transcription factor activity, sequence-specific DNA binding",4.217,0.978,0.000,"transcription factor activity, sequence-specific DNA binding"),
c("GO:0001130","bacterial-type RNA polymerase transcription factor activity, sequence-specific DNA binding",0.000,0.982,0.363,"transcription factor activity, sequence-specific DNA binding"),
c("GO:0001210","transcriptional repressor activity, metal ion regulated sequence-specific DNA binding",0.000,0.975,0.309,"transcription factor activity, sequence-specific DNA binding"),
c("GO:0001216","bacterial-type RNA polymerase transcriptional activator activity, sequence-specific DNA binding",0.000,0.973,0.343,"transcription factor activity, sequence-specific DNA binding"),
c("GO:0001199","transcription factor activity, metal ion regulated sequence-specific DNA binding",0.000,0.982,0.371,"transcription factor activity, sequence-specific DNA binding"),
c("GO:0003735","structural constituent of ribosome",2.679,0.993,0.000,"structural constituent of ribosome"),
c("GO:0005198","structural molecule activity",3.268,0.993,0.000,"structural molecule activity"),
c("GO:0005215","transporter activity",8.494,0.993,0.000,"transporter activity"),
c("GO:0009055","electron carrier activity",1.275,0.993,0.000,"electron carrier activity"),
c("GO:0016987","sigma factor activity",0.517,0.993,0.000,"sigma factor activity"),
c("GO:0030234","enzyme regulator activity",0.856,0.977,0.000,"enzyme regulator activity"),
c("GO:0060703","deoxyribonuclease inhibitor activity",0.000,0.981,0.509,"enzyme regulator activity"),
c("GO:0031992","energy transducer activity",0.012,0.993,0.000,"energy transducer activity"),
c("GO:0034257","nicotinamide riboside transmembrane transporter activity",0.013,0.960,0.000,"nicotinamide riboside transmembrane transporter activity"),
c("GO:0022803","passive transmembrane transporter activity",0.699,0.953,0.538,"nicotinamide riboside transmembrane transporter activity"),
c("GO:0015267","channel activity",0.699,0.944,0.401,"nicotinamide riboside transmembrane transporter activity"),
c("GO:0022857","transmembrane transporter activity",5.870,0.953,0.579,"nicotinamide riboside transmembrane transporter activity"),
c("GO:0015343","siderophore transmembrane transporter activity",0.024,0.959,0.342,"nicotinamide riboside transmembrane transporter activity"),
c("GO:0015144","carbohydrate transmembrane transporter activity",0.325,0.942,0.499,"nicotinamide riboside transmembrane transporter activity"),
c("GO:0034291","canonical holin activity",0.000,0.960,0.563,"nicotinamide riboside transmembrane transporter activity"),
c("GO:0034290","holin activity",0.000,0.961,0.563,"nicotinamide riboside transmembrane transporter activity"),
c("GO:0044823","retroviral integrase activity",0.000,0.970,0.000,"retroviral integrase activity"),
c("GO:0008979","prophage integrase activity",0.000,0.968,0.500,"retroviral integrase activity"),
c("GO:0044824","retroviral 3' processing activity",0.000,0.853,0.473,"retroviral integrase activity"),
c("GO:0046812","host cell surface binding",0.001,0.979,0.000,"host cell surface binding"),
c("GO:0098772","molecular function regulator",1.115,0.993,0.000,"molecular function regulator"),
c("GO:0009009","site-specific recombinase activity",0.041,0.966,0.012,"site-specific recombinase activity"),
c("GO:0033973","dCTP deaminase (dUMP-forming) activity",0.000,0.902,0.012,"dCTP deaminase (dUMP-forming) activity"),
c("GO:0016814","hydrolase activity, acting on carbon-nitrogen (but not peptide) bonds, in cyclic amidines",0.379,0.835,0.652,"dCTP deaminase (dUMP-forming) activity"),
c("GO:0004132","dCMP deaminase activity",0.015,0.863,0.486,"dCTP deaminase (dUMP-forming) activity"),
c("GO:0003934","GTP cyclohydrolase I activity",0.040,0.855,0.668,"dCTP deaminase (dUMP-forming) activity"),
c("GO:0008829","dCTP deaminase activity",0.020,0.861,0.691,"dCTP deaminase (dUMP-forming) activity"),
c("GO:0004040","amidase activity",0.144,0.845,0.515,"dCTP deaminase (dUMP-forming) activity"),
c("GO:0047507","(deoxy)nucleoside-phosphate kinase activity",0.000,0.918,0.013,"(deoxy)nucleoside-phosphate kinase activity"),
c("GO:0016765","transferase activity, transferring alkyl or aryl (other than methyl) groups",0.753,0.896,0.234,"(deoxy)nucleoside-phosphate kinase activity"),
c("GO:0016772","transferase activity, transferring phosphorus-containing groups",8.504,0.869,0.413,"(deoxy)nucleoside-phosphate kinase activity"),
c("GO:0016757","transferase activity, transferring glycosyl groups",1.986,0.887,0.280,"(deoxy)nucleoside-phosphate kinase activity"),
c("GO:0016773","phosphotransferase activity, alcohol group as acceptor",4.703,0.844,0.645,"(deoxy)nucleoside-phosphate kinase activity"),
c("GO:0016776","phosphotransferase activity, phosphate group as acceptor",0.359,0.876,0.369,"(deoxy)nucleoside-phosphate kinase activity"),
c("GO:0016778","diphosphotransferase activity",0.128,0.885,0.214,"(deoxy)nucleoside-phosphate kinase activity"),
c("GO:0016779","nucleotidyltransferase activity",1.954,0.857,0.472,"(deoxy)nucleoside-phosphate kinase activity"),
c("GO:0019206","nucleoside kinase activity",0.065,0.881,0.520,"(deoxy)nucleoside-phosphate kinase activity"),
c("GO:0019205","nucleobase-containing compound kinase activity",0.345,0.874,0.430,"(deoxy)nucleoside-phosphate kinase activity"),
c("GO:0004713","protein tyrosine kinase activity",0.138,0.882,0.340,"(deoxy)nucleoside-phosphate kinase activity"),
c("GO:0042083","5,10-methylenetetrahydrofolate-dependent methyltransferase activity",0.053,0.900,0.609,"(deoxy)nucleoside-phosphate kinase activity"),
c("GO:0050797","thymidylate synthase (FAD) activity",0.013,0.905,0.540,"(deoxy)nucleoside-phosphate kinase activity"),
c("GO:0008174","mRNA methyltransferase activity",0.011,0.908,0.533,"(deoxy)nucleoside-phosphate kinase activity"),
c("GO:0008168","methyltransferase activity",2.784,0.865,0.346,"(deoxy)nucleoside-phosphate kinase activity"),
c("GO:0004810","tRNA adenylyltransferase activity",0.028,0.884,0.304,"(deoxy)nucleoside-phosphate kinase activity"),
c("GO:0016748","succinyltransferase activity",0.062,0.901,0.617,"(deoxy)nucleoside-phosphate kinase activity"),
c("GO:0016747","transferase activity, transferring acyl groups other than amino-acyl groups",2.285,0.871,0.320,"(deoxy)nucleoside-phosphate kinase activity"),
c("GO:0016746","transferase activity, transferring acyl groups",2.893,0.883,0.336,"(deoxy)nucleoside-phosphate kinase activity"),
c("GO:0016741","transferase activity, transferring one-carbon groups",3.043,0.882,0.350,"(deoxy)nucleoside-phosphate kinase activity"),
c("GO:0016749","N-succinyltransferase activity",0.032,0.902,0.582,"(deoxy)nucleoside-phosphate kinase activity"),
c("GO:0004842","ubiquitin-protein transferase activity",0.352,0.902,0.190,"(deoxy)nucleoside-phosphate kinase activity"),
c("GO:0008728","GTP diphosphokinase activity",0.013,0.898,0.288,"(deoxy)nucleoside-phosphate kinase activity"),
c("GO:0008933","lytic transglycosylase activity",0.073,0.895,0.528,"(deoxy)nucleoside-phosphate kinase activity"),
c("GO:0015667","site-specific DNA-methyltransferase (cytosine-N4-specific) activity",0.010,0.906,0.531,"(deoxy)nucleoside-phosphate kinase activity"),
c("GO:0004514","nicotinate-nucleotide diphosphorylase (carboxylating) activity",0.066,0.909,0.113,"(deoxy)nucleoside-phosphate kinase activity"),
c("GO:0003968","RNA-directed 5'-3' RNA polymerase activity",0.034,0.879,0.477,"(deoxy)nucleoside-phosphate kinase activity"),
c("GO:0003964","RNA-directed DNA polymerase activity",0.080,0.874,0.510,"(deoxy)nucleoside-phosphate kinase activity"),
c("GO:0097747","RNA polymerase activity",0.489,0.858,0.620,"(deoxy)nucleoside-phosphate kinase activity"),
c("GO:0080146","L-cysteine desulfhydrase activity",0.004,0.953,0.016,"L-cysteine desulfhydrase activity"),
c("GO:0004122","cystathionine beta-synthase activity",0.008,0.947,0.327,"L-cysteine desulfhydrase activity"),
c("GO:0004124","cysteine synthase activity",0.045,0.943,0.501,"L-cysteine desulfhydrase activity"),
c("GO:0016835","carbon-oxygen lyase activity",1.304,0.933,0.589,"L-cysteine desulfhydrase activity"),
c("GO:0016846","carbon-sulfur lyase activity",0.143,0.943,0.402,"L-cysteine desulfhydrase activity"),
c("GO:0043365","[formate-C-acetyltransferase]-activating enzyme activity",0.023,0.947,0.018,"[formate-C-acetyltransferase]-activating enzyme activity"),
c("GO:0015035","protein disulfide oxidoreductase activity",0.305,0.938,0.310,"[formate-C-acetyltransferase]-activating enzyme activity"),
c("GO:0016646","oxidoreductase activity, acting on the CH-NH group of donors, NAD or NADP as acceptor",0.239,0.935,0.291,"[formate-C-acetyltransferase]-activating enzyme activity"),
c("GO:0016645","oxidoreductase activity, acting on the CH-NH group of donors",0.305,0.938,0.303,"[formate-C-acetyltransferase]-activating enzyme activity"),
c("GO:0016728","oxidoreductase activity, acting on CH or CH2 groups, disulfide as acceptor",0.090,0.930,0.270,"[formate-C-acetyltransferase]-activating enzyme activity"),
c("GO:0016725","oxidoreductase activity, acting on CH or CH2 groups",0.187,0.940,0.245,"[formate-C-acetyltransferase]-activating enzyme activity"),
c("GO:0016705","oxidoreductase activity, acting on paired donors, with incorporation or reduction of molecular oxygen",1.177,0.931,0.377,"[formate-C-acetyltransferase]-activating enzyme activity"),
c("GO:0016620","oxidoreductase activity, acting on the aldehyde or oxo group of donors, NAD or NADP as acceptor",0.395,0.933,0.338,"[formate-C-acetyltransferase]-activating enzyme activity"),
c("GO:0016903","oxidoreductase activity, acting on the aldehyde or oxo group of donors",0.627,0.934,0.330,"[formate-C-acetyltransferase]-activating enzyme activity"),
c("GO:0008907","integrase activity",0.041,0.966,0.018,"integrase activity"),
c("GO:0000150","recombinase activity",0.105,0.965,0.020,"recombinase activity"),
c("GO:0070279","vitamin B6 binding",0.000,0.964,0.020,"vitamin B6 binding"),
c("GO:0000822","inositol hexakisphosphate binding",0.002,0.961,0.127,"vitamin B6 binding"),
c("GO:0043178","alcohol binding",0.020,0.963,0.103,"vitamin B6 binding"),
c("GO:0031418","L-ascorbic acid binding",0.062,0.946,0.448,"vitamin B6 binding"),
c("GO:0019842","vitamin binding",0.634,0.953,0.179,"vitamin B6 binding"),
c("GO:0061783","peptidoglycan muralytic activity",0.218,0.963,0.022,"peptidoglycan muralytic activity"),
c("GO:0016886","ligase activity, forming phosphoric ester bonds",0.135,0.938,0.022,"ligase activity, forming phosphoric ester bonds"),
c("GO:0016881","acid-amino acid ligase activity",0.396,0.932,0.658,"ligase activity, forming phosphoric ester bonds"),
c("GO:0016879","ligase activity, forming carbon-nitrogen bonds",1.406,0.927,0.593,"ligase activity, forming phosphoric ester bonds"),
c("GO:0008452","RNA ligase activity",0.038,0.930,0.445,"ligase activity, forming phosphoric ester bonds"),
c("GO:0019239","deaminase activity",0.250,0.963,0.024,"deaminase activity"),
c("GO:0004803","transposase activity",0.307,0.962,0.024,"transposase activity"),
c("GO:0008144","drug binding",0.178,0.972,0.029,"drug binding"),
c("GO:0016853","isomerase activity",2.691,0.955,0.030,"isomerase activity"),
c("GO:0016854","racemase and epimerase activity",0.403,0.950,0.031,"racemase and epimerase activity"),
c("GO:0016857","racemase and epimerase activity, acting on carbohydrates and derivatives",0.238,0.949,0.609,"racemase and epimerase activity"),
c("GO:0030955","potassium ion binding",0.074,0.956,0.038,"potassium ion binding"),
c("GO:0000287","magnesium ion binding",1.785,0.943,0.365,"potassium ion binding"),
c("GO:0050897","cobalt ion binding",0.042,0.955,0.211,"potassium ion binding"),
c("GO:0043169","cation binding",15.599,0.942,0.160,"potassium ion binding"),
c("GO:0031420","alkali metal ion binding",0.091,0.955,0.222,"potassium ion binding"),
c("GO:0046914","transition metal ion binding",6.942,0.933,0.691,"potassium ion binding"),
c("GO:0046872","metal ion binding",15.425,0.927,0.532,"potassium ion binding"),
c("GO:0008270","zinc ion binding",4.511,0.934,0.683,"potassium ion binding"),
c("GO:0035639","purine ribonucleoside triphosphate binding",15.815,0.910,0.672,"potassium ion binding"),
c("GO:0005506","iron ion binding",1.548,0.940,0.416,"potassium ion binding"),
c("GO:0005509","calcium ion binding",0.967,0.946,0.272,"potassium ion binding"),
c("GO:0005524","ATP binding",14.125,0.904,0.381,"potassium ion binding"),
c("GO:0051087","chaperone binding",0.101,0.954,0.039,"chaperone binding"),
c("GO:0046983","protein dimerization activity",1.157,0.946,0.610,"chaperone binding"),
c("GO:0008134","transcription factor binding",0.320,0.951,0.503,"chaperone binding"),
c("GO:0003779","actin binding",0.326,0.951,0.520,"chaperone binding"),
c("GO:0051082","unfolded protein binding",0.486,0.949,0.550,"chaperone binding"),
c("GO:0042802","identical protein binding",0.400,0.950,0.531,"chaperone binding"),
c("GO:0042803","protein homodimerization activity",0.221,0.952,0.459,"chaperone binding"),
c("GO:0016874","ligase activity",3.540,0.954,0.041,"ligase activity"),
c("GO:0016829","lyase activity",3.596,0.954,0.043,"lyase activity"),
c("GO:0030246","carbohydrate binding",0.723,0.970,0.046,"carbohydrate binding"),
c("GO:0001067","regulatory region nucleic acid binding",0.282,0.943,0.050,"regulatory region nucleic acid binding"),
c("GO:0000405","bubble DNA binding",0.001,0.941,0.680,"regulatory region nucleic acid binding"),
c("GO:0008135","translation factor activity, RNA binding",0.909,0.930,0.502,"regulatory region nucleic acid binding"),
c("GO:0016149","translation release factor activity, codon specific",0.104,0.935,0.420,"regulatory region nucleic acid binding"),
c("GO:0008079","translation termination factor activity",0.135,0.935,0.691,"regulatory region nucleic acid binding"),
c("GO:0043565","sequence-specific DNA binding",2.222,0.923,0.399,"regulatory region nucleic acid binding"),
c("GO:0003723","RNA binding",5.283,0.926,0.277,"regulatory region nucleic acid binding"),
c("GO:0001047","core promoter binding",0.045,0.935,0.262,"regulatory region nucleic acid binding"),
c("GO:0003729","mRNA binding",0.168,0.938,0.199,"regulatory region nucleic acid binding"),
c("GO:0097100","supercoiled DNA binding",0.001,0.942,0.142,"regulatory region nucleic acid binding"),
c("GO:0003677","DNA binding",12.549,0.919,0.487,"regulatory region nucleic acid binding"),
c("GO:0003684","damaged DNA binding",0.291,0.935,0.304,"regulatory region nucleic acid binding"),
c("GO:0003697","single-stranded DNA binding",0.219,0.936,0.208,"regulatory region nucleic acid binding"),
c("GO:0003688","DNA replication origin binding",0.057,0.931,0.267,"regulatory region nucleic acid binding"),
c("GO:0003690","double-stranded DNA binding",0.508,0.932,0.326,"regulatory region nucleic acid binding"),
c("GO:0016491","oxidoreductase activity",12.783,0.948,0.053,"oxidoreductase activity"),
c("GO:0051536","iron-sulfur cluster binding",2.054,0.961,0.059,"iron-sulfur cluster binding"),
c("GO:0051540","metal cluster binding",2.056,0.967,0.067,"metal cluster binding"),
c("GO:0047846","deoxynucleotide 3'-phosphatase activity",0.000,0.874,0.072,"deoxynucleotide 3prime-phosphatase activity"),
c("GO:0008962","phosphatidylglycerophosphatase activity",0.017,0.816,0.448,"deoxynucleotide 3prime-phosphatase activity"),
c("GO:0016794","diphosphoric monoester hydrolase activity",0.004,0.832,0.415,"deoxynucleotide 3prime-phosphatase activity"),
c("GO:0004113","2',3'-cyclic-nucleotide 3'-phosphodiesterase activity",0.016,0.816,0.486,"deoxynucleotide 3prime-phosphatase activity"),
c("GO:0042578","phosphoric ester hydrolase activity",1.364,0.764,0.625,"deoxynucleotide 3prime-phosphatase activity"),
c("GO:0008138","protein tyrosine/serine/threonine phosphatase activity",0.094,0.795,0.621,"deoxynucleotide 3prime-phosphatase activity"),
c("GO:0008081","phosphoric diester hydrolase activity",0.301,0.779,0.663,"deoxynucleotide 3prime-phosphatase activity"),
c("GO:0046555","acetylxylan esterase activity",0.001,0.855,0.212,"deoxynucleotide 3prime-phosphatase activity"),
c("GO:0008253","5'-nucleotidase activity",0.048,0.804,0.555,"deoxynucleotide 3prime-phosphatase activity"),
c("GO:0048256","flap endonuclease activity",0.022,0.793,0.633,"deoxynucleotide 3prime-phosphatase activity"),
c("GO:0052689","carboxylic ester hydrolase activity",0.623,0.779,0.480,"deoxynucleotide 3prime-phosphatase activity"),
c("GO:0008893","guanosine-3',5'-bis(diphosphate) 3'-diphosphatase activity",0.004,0.832,0.318,"deoxynucleotide 3prime-phosphatase activity"),
c("GO:0016889","endodeoxyribonuclease activity, producing 3'-phosphomonoesters",0.048,0.782,0.683,"deoxynucleotide 3prime-phosphatase activity"),
c("GO:0016893","endonuclease activity, active with either ribo- or deoxyribonucleic acids and producing 5'-phosphomonoesters",0.401,0.761,0.699,"deoxynucleotide 3prime-phosphatase activity"),
c("GO:0016894","endonuclease activity, active with either ribo- or deoxyribonucleic acids and producing 3'-phosphomonoesters",0.083,0.786,0.533,"deoxynucleotide 3prime-phosphatase activity"),
c("GO:0008409","5'-3' exonuclease activity",0.080,0.791,0.469,"deoxynucleotide 3prime-phosphatase activity"),
c("GO:0004536","deoxyribonuclease activity",0.533,0.762,0.610,"deoxynucleotide 3prime-phosphatase activity"),
c("GO:1990238","double-stranded DNA endodeoxyribonuclease activity",0.000,0.856,0.182,"deoxynucleotide 3prime-phosphatase activity"),
c("GO:0000704","pyrimidine dimer DNA N-glycosylase activity",0.000,0.829,0.340,"deoxynucleotide 3prime-phosphatase activity"),
c("GO:0008833","deoxyribonuclease IV (phage-T4-induced) activity",0.014,0.796,0.444,"deoxynucleotide 3prime-phosphatase activity"),
c("GO:0033922","peptidoglycan beta-N-acetylmuramidase activity",0.000,0.898,0.074,"peptidoglycan beta-N-acetylmuramidase activity"),
c("GO:0016799","hydrolase activity, hydrolyzing N-glycosyl compounds",0.245,0.830,0.579,"peptidoglycan beta-N-acetylmuramidase activity"),
c("GO:0004650","polygalacturonase activity",0.051,0.846,0.531,"peptidoglycan beta-N-acetylmuramidase activity"),
c("GO:0046556","alpha-L-arabinofuranosidase activity",0.032,0.850,0.504,"peptidoglycan beta-N-acetylmuramidase activity"),
c("GO:0019104","DNA N-glycosylase activity",0.171,0.833,0.635,"peptidoglycan beta-N-acetylmuramidase activity"),
c("GO:0016997","alpha-sialidase activity",0.022,0.854,0.492,"peptidoglycan beta-N-acetylmuramidase activity"),
c("GO:0016996","endo-alpha-(2,8)-sialidase activity",0.000,0.894,0.266,"peptidoglycan beta-N-acetylmuramidase activity"),
c("GO:0004568","chitinase activity",0.021,0.854,0.348,"peptidoglycan beta-N-acetylmuramidase activity"),
c("GO:0008843","endochitinase activity",0.000,0.883,0.394,"peptidoglycan beta-N-acetylmuramidase activity"),
c("GO:0005515","protein binding",4.410,0.964,0.074,"protein binding"),
c("GO:0050662","coenzyme binding",3.468,0.948,0.080,"coenzyme binding"),
c("GO:0050661","NADP binding",0.587,0.931,0.640,"coenzyme binding"),
c("GO:0030170","pyridoxal phosphate binding",1.157,0.929,0.696,"coenzyme binding"),
c("GO:0070403","NAD+ binding",0.096,0.934,0.528,"coenzyme binding"),
c("GO:0048037","cofactor binding",5.599,0.963,0.087,"cofactor binding"),
c("GO:0004170","dUTP diphosphatase activity",0.031,0.854,0.098,"dUTP diphosphatase activity"),
c("GO:0016798","hydrolase activity, acting on glycosyl bonds",1.822,0.833,0.290,"dUTP diphosphatase activity"),
c("GO:0016817","hydrolase activity, acting on acid anhydrides",7.223,0.809,0.409,"dUTP diphosphatase activity"),
c("GO:0016810","hydrolase activity, acting on carbon-nitrogen (but not peptide) bonds",1.786,0.834,0.193,"dUTP diphosphatase activity"),
c("GO:0016788","hydrolase activity, acting on ester bonds",4.643,0.817,0.372,"dUTP diphosphatase activity"),
c("GO:0004197","cysteine-type endopeptidase activity",0.093,0.846,0.597,"dUTP diphosphatase activity"),
c("GO:0004190","aspartic-type endopeptidase activity",0.269,0.834,0.666,"dUTP diphosphatase activity"),
c("GO:0004176","ATP-dependent peptidase activity",0.094,0.815,0.598,"dUTP diphosphatase activity"),
c("GO:0047429","nucleoside-triphosphate diphosphatase activity",0.138,0.838,0.352,"dUTP diphosphatase activity"),
c("GO:0008094","DNA-dependent ATPase activity",0.593,0.810,0.601,"dUTP diphosphatase activity"),
c("GO:0004386","helicase activity",1.222,0.806,0.446,"dUTP diphosphatase activity"),
c("GO:0008186","RNA-dependent ATPase activity",0.106,0.833,0.365,"dUTP diphosphatase activity"),
c("GO:0004427","inorganic diphosphatase activity",0.064,0.847,0.318,"dUTP diphosphatase activity"),
c("GO:0008234","cysteine-type peptidase activity",0.411,0.830,0.697,"dUTP diphosphatase activity"),
c("GO:0008233","peptidase activity",4.049,0.820,0.357,"dUTP diphosphatase activity"),
c("GO:0070001","aspartic-type peptidase activity",0.269,0.836,0.666,"dUTP diphosphatase activity"),
c("GO:0003724","RNA helicase activity",0.087,0.833,0.360,"dUTP diphosphatase activity"),
c("GO:0003918","DNA topoisomerase type II (ATP-hydrolyzing) activity",0.138,0.818,0.614,"dUTP diphosphatase activity"),
c("GO:0070011","peptidase activity, acting on L-amino acid peptides",3.584,0.796,0.318,"dUTP diphosphatase activity"),
c("GO:0016887","ATPase activity",4.560,0.780,0.670,"dUTP diphosphatase activity"));
stuff <- data.frame(revigo.data);
names(stuff) <- revigo.names;
stuff$abslog10pvalue <- as.numeric( as.character(stuff$abslog10pvalue) );
stuff$freqInDbPercent <- as.numeric( as.character(stuff$freqInDbPercent) );
stuff$uniqueness <- as.numeric( as.character(stuff$uniqueness) );
stuff$dispensability <- as.numeric( as.character(stuff$dispensability) );
# by default, outputs to a PDF file
pdf( file="revigo_treemap.pdf", width=16, height=9 ) # width and height are in inches
# check the tmPlot command documentation for all possible parameters - there are a lot more
tmPlot(
stuff,
index = c("representative","description"),
vSize = "abslog10pvalue",
type = "categorical",
vColor = "representative",
title = "REVIGO Gene Ontology treemap",
inflate.labels = FALSE,      # set this to TRUE for space-filling group labels - good for posters
lowerbound.cex.labels = 0,   # try to draw as many labels as possible (still, some small squares may not get a label)
bg.labels = "#CCCCCCAA",     # define background color of group labels
# "#CCCCCC00" is fully transparent, "#CCCCCCAA" is semi-transparent grey, NA is opaque
position.legend = "none"
)
dev.off()
# check the tmPlot command documentation for all possible parameters - there are a lot more
treemap(
stuff,
index = c("representative","description"),
vSize = "abslog10pvalue",
type = "categorical",
vColor = "representative",
title = "REVIGO Gene Ontology treemap",
inflate.labels = FALSE,      # set this to TRUE for space-filling group labels - good for posters
lowerbound.cex.labels = 0,   # try to draw as many labels as possible (still, some small squares may not get a label)
bg.labels = "#CCCCCCAA",     # define background color of group labels
# "#CCCCCC00" is fully transparent, "#CCCCCCAA" is semi-transparent grey, NA is opaque
position.legend = "none"
)
# check the tmPlot command documentation for all possible parameters - there are a lot more
treemap(
stuff,
index = c("representative","description"),
type = "categorical",
vColor = "representative",
title = "REVIGO Gene Ontology treemap",
inflate.labels = FALSE,      # set this to TRUE for space-filling group labels - good for posters
lowerbound.cex.labels = 0,   # try to draw as many labels as possible (still, some small squares may not get a label)
bg.labels = "#CCCCCCAA",     # define background color of group labels
# "#CCCCCC00" is fully transparent, "#CCCCCCAA" is semi-transparent grey, NA is opaque
position.legend = "none"
)
# check the tmPlot command documentation for all possible parameters - there are a lot more
treemap(
stuff,
index = c("representative","description"),
vSize= 2
type = "categorical",
vColor = "representative",
title = "REVIGO Gene Ontology treemap",
inflate.labels = FALSE,      # set this to TRUE for space-filling group labels - good for posters
lowerbound.cex.labels = 0,   # try to draw as many labels as possible (still, some small squares may not get a label)
bg.labels = "#CCCCCCAA",     # define background color of group labels
# "#CCCCCC00" is fully transparent, "#CCCCCCAA" is semi-transparent grey, NA is opaque
position.legend = "none"
)
# check the tmPlot command documentation for all possible parameters - there are a lot more
treemap(
stuff,
index = c("representative","description"),
vSize= 2,
type = "categorical",
vColor = "representative",
title = "REVIGO Gene Ontology treemap",
inflate.labels = FALSE,      # set this to TRUE for space-filling group labels - good for posters
lowerbound.cex.labels = 0,   # try to draw as many labels as possible (still, some small squares may not get a label)
bg.labels = "#CCCCCCAA",     # define background color of group labels
# "#CCCCCC00" is fully transparent, "#CCCCCCAA" is semi-transparent grey, NA is opaque
position.legend = "none"
)
stuff
stuff$term_ID
# check the tmPlot command documentation for all possible parameters - there are a lot more
treemap(
stuff,
index = c("representative","description"),
vSize= 2,
type = "categorical",
vColor = "representative",
title = "REVIGO Gene Ontology treemap",
inflate.labels = FALSE,      # set this to TRUE for space-filling group labels - good for posters
lowerbound.cex.labels = 0,   # try to draw as many labels as possible (still, some small squares may not get a label)
bg.labels = "#CCCCCCAA",     # define background color of group labels
# "#CCCCCC00" is fully transparent, "#CCCCCCAA" is semi-transparent grey, NA is opaque
position.legend = "none"
)
# check the tmPlot command documentation for all possible parameters - there are a lot more
treemap(
stuff,
index = c("representative","description"),
type = "categorical",
vColor = "representative",
title = "REVIGO Gene Ontology treemap",
inflate.labels = FALSE,      # set this to TRUE for space-filling group labels - good for posters
lowerbound.cex.labels = 0,   # try to draw as many labels as possible (still, some small squares may not get a label)
bg.labels = "#CCCCCCAA",     # define background color of group labels
# "#CCCCCC00" is fully transparent, "#CCCCCCAA" is semi-transparent grey, NA is opaque
position.legend = "none"
)
?treemap
stuff$freqInDbPercent
# check the tmPlot command documentation for all possible parameters - there are a lot more
treemap(
stuff,
index = c("representative","description"),
type = "categorical",
vSize= "freqInDbPercent",
vColor = "representative",
title = "REVIGO Gene Ontology treemap",
inflate.labels = FALSE,      # set this to TRUE for space-filling group labels - good for posters
lowerbound.cex.labels = 0,   # try to draw as many labels as possible (still, some small squares may not get a label)
bg.labels = "#CCCCCCAA",     # define background color of group labels
# "#CCCCCC00" is fully transparent, "#CCCCCCAA" is semi-transparent grey, NA is opaque
position.legend = "none"
)
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("SRAdb")
library("sradb")
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("SRAdb")
library("SRAdb")
load("~/Bioinf/Notebooks/Beevirus_analysis/EUVIR_paper/pcoa/Pcoa.workspace.RData")
#Ordination plotting
sra_distmat <- vegdist(SRAdf_norm, method='bray')
sra_pcoa <- pcoa(sra_distmat)
rownames(sra_pcoa$vectors)
pcoa_col <- acc_EUtax_Country[match(rownames(sra_pcoa$vectors), rownames(acc_EUtax_Country)),]
ggplot() + geom_point(aes(x=sra_pcoa$vectors[,1], y=sra_pcoa$vectors[,2], col=pcoa_col$Country))
library(vegan)
library("phyloseq")
library(ggplot2)
library(ape)
sra_distmat <- vegdist(SRAdf_norm, method='bray')
sra_pcoa <- pcoa(sra_distmat)
rownames(sra_pcoa$vectors)
pcoa_col <- acc_EUtax_Country[match(rownames(sra_pcoa$vectors), rownames(acc_EUtax_Country)),]
ggplot() + geom_point(aes(x=sra_pcoa$vectors[,1], y=sra_pcoa$vectors[,2], col=pcoa_col$Country))
plot(cap_country,type="n")
load("~/Bioinf/Notebooks/Beevirus_analysis/EUVIR_paper/trees/Treeplots.R")
metadat <- read.csv("~/Desktop/Metadata_location_year_study_kind.csv", sep=";")
View(metadat)
metadat$Run
metadat[metadat$Run %in% keepers]
keepers <- c('SRR2146246','SRR2146246','SRR2146246','SRR2146247','SRR2146248','SRR2146249','SRR2146250','SRR2146251','SRR3033254','SRR3033262','SRR3569812','SRR3569813','SRR3657423','SRR3657424','SRR3675070','SRR3675077','SRR3927501','SRR4002869','SRR4002869','SRR4002870','SRR4002870','SRR4002873','SRR4002874','SRR4002875','SRR4002875','SRR4002876','SRR4002876','SRR4002877','SRR4002878','SRR4002891','SRR4002892','SRR4002893','SRR4002894','SRR4002895','SRR4002895','SRR4002898','SRR4002899','SRR4013500','SRR4013516','SRR4017751','SRR4017751','SRR4017752','SRR4017755','SRR4017756','SRR4017758','SRR4017759','SRR4017759','SRR4017760','SRR4017761','SRR4017762','SRR4017763','SRR4017765','SRR4017767','SRR4017767','SRR4017768','SRR4017769','SRR4017769','SRR4017770','SRR4017771','SRR4017771','SRR4017773','SRR4017774','SRR4017781','SRR4017785','SRR4017786','SRR4017794','SRR4017797','SRR4017797','SRR4045713','SRR4045715','SRR4045715','SRR4045716','SRR4045726','SRR4045744','SRR4045745','SRR4045746','SRR4045748','SRR4045754','SRR4045764','SRR4045764','SRR4045771','SRR4045804','SRR4045809','SRR4045818','SRR4045820','SRR4045830','SRR4045837','SRR4045850','SRR4045855','SRR4045859','SRR4250143','SRR4250145','SRR4250152','SRR4250158','SRR4250161','SRR4250164','SRR4250164','SRR4250166','SRR4250169','SRR4250170','SRR4250171','SRR4250172','SRR4250173','SRR4250175','SRR4250176','SRR4250177','SRR4250178','SRR4292728','SRR4343848','SRR499920','SRR499994','SRR5109820','SRR5109821','SRR5109822','SRR5109826','SRR5109828','SRR5109829','SRR5109832','SRR5109834','SRR5109834','SRR5109834','SRR5116304','SRR5116306','SRR5116307','SRR5136448','SRR5136449','SRR5136450','SRR5136451','SRR5136451','SRR5136452','SRR5136452','SRR5136453','SRR5136453','SRR5136454','SRR5136454','SRR5136457','SRR5252792','SRR5252793','SRR5252793','SRR5252798','SRR5252800','SRR5252802','SRR5252802','SRR5252803','SRR5252806','SRR5252806','SRR5383927','SRR5383927','SRR5383927','SRR5383927','SRR5383927','SRR5383937','SRR5383937','SRR5383937','SRR5383939','SRR5383939','SRR5383939','SRR5383939','SRR5387735','SRR5387737','SRR5387737','SRR5387737','SRR5387737','SRR5387738','SRR5387738','SRR5387738','SRR5387738','SRR5760506','SRR584147','SRR5907691','SRR5907695','SRR5907702','SRR5907702','SRR6031648','SRR6031648','SRR6031650','SRR6047309','SRR6047309','SRR6047311','SRR6047311','SRR6047312','SRR6047312','SRR6047315','SRR634130','SRR6823685','SRR6823685','SRR6833955','SRR6833955','SRR6833958','SRR6833960','SRR6833961','SRR6833962','SRR6833964','SRR6833965','SRR6901841','SRR6901841','SRR6901843','SRR6901856','SRR6901857','SRR6901857','SRR6901858','SRR6901858','SRR6901861','SRR765681','SRR789764','SRR801788','SRR801788','SRR989676')
metadat[metadat$Run %in% keepers]
metadat[metadat$Run %in% keepers,]
keepers
metadat$Date
metadat$Tax_family
metadat[metadat$Run %in% keepers,c('Date','ISO3','ScientificName')]
metadat[metadat$Run %in% keepers,c('Run','Date','ISO3','ScientificName')]
merge(keepers, metadat[metadat$Run %in% keepers,c('Run','Date','ISO3','ScientificName')])
keepdr <- as.dataframe(keepers)
keepdr <- as.data.frame(keepers)
keepdr
colnames(keepdr)
colnames(keepdr) <- c("Run")
datsub <- metadat[metadat$Run %in% keepers,c('Run','Date','ISO3','ScientificName')]
merge(keepdr, datsub, by="Run")
setwd("/Users/wd/Bioinf/Analysis/Minion/ProtvsUniprot_length")
hitlen <- read.delim("~/Bioinf/Analysis/Minion/ProtvsUniprot_length/hitlen.tsv")
View(hitlen)
class(hitlen$contiglen)
class(hitlen$reflen)
hitlen$rat <- hitlen$contiglen/hitlen$reflen
hist(histlen$rat)
hist(hitlen$rat)
hitlen$rat
?hist
hitlen$diff<- hitlen$contiglen - hitlen$reflen
hist(hitlen$diff)
hitlen$rat<- hitlen$contiglen/hitlen$reflen
hist(hitlen$rat)
setwd("/Users/wd/Bioinf/Analysis/Minion/ProtvsUniprot_length")
hitlen <- read.delim("~/Bioinf/Analysis/Minion/ProtvsUniprot_length/hitlen.tsv")
hitlen$rat<- hitlen$contiglen/hitlen$reflen
hist(hitlen$rat)
?hist
hist(hitlen$rat, breaks = c(0,0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1,1.1,1.2,1.3))
max(hitlen$rat)
hist(hitlen$rat, breaks = c(0,0.5,0.6,0.7,0.8,0.9,1,1.1,1.2,1.3,1.5,2,5,10,15,20))
library("ggplot2")
ggplot(hitlen, aes(x=rat)) + geom_density()
ggplot(hitlen, aes(x=rat)) + geom_density() + theme_minimal()
ggplot(hitlen, aes(x=rat)) +
geom_density() +
theme_minimal() +
geom_vline(xintercept = 1, linetype="dotted", color = "red", size=1.5)
ggplot(hitlen, aes(x=rat)) +
geom_density() +
theme_minimal() +
geom_vline(xintercept = 1, linetype="dotted", color = "red", size=0.5)
library("genoPlotR")
setwd('/Users/wd/Bioinf/repo/Beevir/6Genome_const/data')
GenoplotR_df <- read.csv("~/Bioinf/repo/Beevir/6Genome_const/output/GenoplotR_df.csv", row.names=1)
levels(GenoplotR_df$Contig)
df1 <- GenoplotR_df[GenoplotR_df$Contig == 'BeeP-06-2013_NODE_1_length_28373_cov_138_815486',]
df2 <- GenoplotR_df[GenoplotR_df$Contig == 'BeeP-11-2013_NODE_1_length_180431_cov_45_996640',]
df3 <- GenoplotR_df[GenoplotR_df$Contig == 'BeeP-11-2013_NODE_17_length_39362_cov_35_956828',]
df4 <- GenoplotR_df[GenoplotR_df$Contig == 'BeeP-11-2013_NODE_2_length_102270_cov_31_231611',]
df5 <- GenoplotR_df[GenoplotR_df$Contig == 'BeeP-11-2013_NODE_457_length_2984_cov_21_251462',]
df6 <- GenoplotR_df[GenoplotR_df$Contig == 'BeeP-11-2013_NODE_6_length_47542_cov_634_671885',]
df7 <- GenoplotR_df[GenoplotR_df$Contig == 'BeeP-11-2013_NODE_61_length_13003_cov_97_347130',]
df8 <- GenoplotR_df[GenoplotR_df$Contig == 'BeeP-11-2013_NODE_8_length_46852_cov_48_771438',]
df9 <- GenoplotR_df[GenoplotR_df$Contig == 'BeeP-35-2013_NODE_1_length_48212_cov_109_842256',]
df10 <- GenoplotR_df[GenoplotR_df$Contig == 'BeeP-36-2013_NODE_1_length_32049_cov_19_863443',]
df11 <- GenoplotR_df[GenoplotR_df$Contig == 'BeeP-37-2013_NODE_2_length_40678_cov_31_109505',]
df12 <- GenoplotR_df[GenoplotR_df$Contig == 'BeeP-38-2013_NODE_1_length_47472_cov_756_510180',]
df13 <- GenoplotR_df[GenoplotR_df$Contig == 'BeeP-43-2013_NODE_2_length_4729_cov_13_984308',]
df14 <- GenoplotR_df[GenoplotR_df$Contig == 'BeeP-45-2013_NODE_1_length_31866_cov_26_676051',]
df15 <- GenoplotR_df[GenoplotR_df$Contig == 'BP23_NODE_2_length_42653_cov_45_250447',]
df16 <- GenoplotR_df[GenoplotR_df$Contig == 'BP32_NODE_2_length_41333_cov_117_683684',]
df17 <- GenoplotR_df[GenoplotR_df$Contig == 'BP49_NODE_1_length_65331_cov_17_543582',]
df18 <- GenoplotR_df[GenoplotR_df$Contig == 'BP50_NODE_1_length_71699_cov_19_894646',]
df19 <- GenoplotR_df[GenoplotR_df$Contig == 'BP50_NODE_4_length_51643_cov_134_843310',]
df20 <- GenoplotR_df[GenoplotR_df$Contig == 'BP50_NODE_5_length_45555_cov_7_532597',]
df1$Contig <- NULL
df2$Contig <- NULL
df3$Contig <- NULL
df4$Contig <- NULL
df5$Contig <- NULL
df6$Contig <- NULL
df7$Contig <- NULL
df8$Contig <- NULL
df9$Contig <- NULL
df10$Contig <- NULL
df11$Contig <- NULL
df12$Contig <- NULL
df13$Contig <- NULL
df14$Contig <- NULL
df15$Contig <- NULL
df16$Contig <- NULL
df17$Contig <- NULL
df18$Contig <- NULL
df19$Contig <- NULL
df20$Contig <- NULL
plot_gene_map(list(dna_seg(df1),dna_seg(df2),dna_seg(df3),dna_seg(df4),dna_seg(df5),dna_seg(df6),dna_seg(df7),dna_seg(df8),dna_seg(df9),dna_seg(df10),dna_seg(df11),dna_seg(df12),dna_seg(df13),dna_seg(df14),dna_seg(df15),dna_seg(df16),dna_seg(df17),dna_seg(df18),dna_seg(df19),dna_seg(df20)))
##gray = #808080
##blue = #0000FF
